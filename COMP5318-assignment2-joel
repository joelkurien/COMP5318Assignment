{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "fc4122b0",
   "metadata": {},
   "source": [
    "# COMP4318/5318 Assignment 2: Image Classification"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "af9f508e",
   "metadata": {},
   "source": [
    "### Group number: ...  , SID1: ... , SID2: ..., SID3: ... "
   ]
  },
  {
   "cell_type": "markdown",
   "id": "e24652d1",
   "metadata": {},
   "source": [
    "This template notebook includes code to load the  dataset and a skeleton for the main sections that should be included in the notebook. Please stick to this struture for your submitted notebook.\n",
    "\n",
    "Please focus on making your code clear, with appropriate variable names and whitespace. Include comments and markdown text to aid the readability of your code where relevant. See the specification and marking criteria in the associated specification to guide you when completing your implementation."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "fe1144e1",
   "metadata": {},
   "source": [
    "## Setup and dependencies\n",
    "Please use this section to list and set up all your required libraries/dependencies and your plotting environment. "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "id": "11ab0507",
   "metadata": {},
   "outputs": [],
   "source": [
    "import numpy as np\n",
    "import matplotlib.pyplot as plt\n",
    "from sklearn.metrics import f1_score, confusion_matrix, roc_curve, auc, RocCurveDisplay\n",
    "from keras_tuner.tuners import BayesianOptimization\n",
    "from tensorflow.keras.utils import to_categorical\n",
    "from tensorflow import keras\n",
    "import tensorflow as tf\n",
    "import seaborn as sns"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "9bc35bce",
   "metadata": {},
   "source": [
    "## 1. Data loading, exploration, and preprocessing\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "7495a12e-9b9d-48f8-9d2a-abbd01c5a594",
   "metadata": {},
   "source": [
    "Code to load the dataset is provided in the following cell. Please proceed with your data exploration and preprocessing in the remainder of this section."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "a991e631",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Load the dataset training and test sets as numpy arrays\n",
    "# assuming Assignment2Data folder is present in the same directory \n",
    "# as the notebook\n",
    "X_train = np.load('Assignment2Data/X_train.npy')\n",
    "y_train = np.load('Assignment2Data/y_train.npy')\n",
    "X_test = np.load('Assignment2Data/X_test.npy')\n",
    "y_test = np.load('Assignment2Data/y_test.npy')"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "68c97ca0-15b8-4101-b6b5-b76431c3ca17",
   "metadata": {},
   "source": [
    "### Examples of preprocessed data\n",
    "Please print/display some examples of your preprocessed data here."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 33,
   "id": "2ed30e70-32f6-47ef-8a0e-873f14ef11f8",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(50000, 32, 32, 3)"
      ]
     },
     "execution_count": 33,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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Fg0AKA1efxN6++23837evXu3qqqqdOzYMS1dujR3exAESiQShakQAFCyJvU3oXQ6LUmaNWtW3u1dXV2qqqrSLbfcoscff1yDg4OXvI9sNqtMJpM3AADlIebcxL4vzzmn1atX68svv9R7772Xu33v3r26/vrrVVdXp76+Pv3ud7/T+fPndezYMQVBMOp+Wltb9fvf/37s4sZby0QmUOKK8CIZSWV0FaB1AShJYV4dN5GkSKfTqqysvOw+Ew6h9evX680339T777+vuXPnXnK/gYEB1dXVac+ePVq7du2o7dlsVtlsNvdzJpNRbW3txeLGWQv/oEcrlxfncpknMB7FGEIT+pzQxo0b9cYbb+jQoUOXDSBJSiaTqqur06lTp8bcHgTBmGdIAIDS5xVCzjlt3LhR+/btU1dXl+rr66/4O2fOnFF/f7+SyeSEiwQAlCavCxPWr1+vv/71r3r11VdVUVGhVCqlVCqlb7/9VpL09ddf66mnntK//vUvffbZZ+rq6tKqVas0e/ZsPfDAA6FMAABQxJwHXXwre9TYvXu3c865b775xjU1Nbk5c+a46dOnuxtvvNG1tLS406dPj/sx0ul07n5j4xyXqqucx3iPXdQG82QwJj5isfDGROpJp9NXfM2f8IUJYclkMorH45I8/sjmMYNITRZTyvdvtjxXJi/MC0fKZX28jmERXphA7zgAgBlCCABghhACAJghhAAAZgghAIAZQggAYIYQAgCYIYQAAGYIIQCAGUIIAGBmQl/lUMxo3VK+WMupxzEvgIi14ik0zoQAAGYIIQCAGUIIAGCGEAIAmCGEAABmCCEAgBlCCABghhACAJghhAAAZgghAIAZQggAYKbsesf5CrFtE321ABSW94tKWK9CGUnxce3JmRAAwAwhBAAwQwgBAMwQQgAAM4QQAMAMIQQAMEMIAQDMEEIAADOEEADADCEEADBTGm17wuyt48OzAwYtgVBsfJ+zPA/H4ndUnBv/UQ/3pTCce+dMCABghhACAJghhAAAZgghAIAZQggAYIYQAgCYIYQAAGYIIQCAGUIIAGCGEAIAmCGEAABmot07LgqNp3zaJUWlh52kWIjHLgrLAhus/aV4HBnfgxjq64r9ixZnQgAAM14htHPnTt15552qrKxUZWWlGhoa9NZbb+W2O+fU2tqqmpoazZw5U8uXL9fJkycLXjQAoDR4hdDcuXPV3t6uo0eP6ujRo1qxYoVWr16dC5rt27drx44d6ujoUE9PjxKJhFauXKmhoaFQigcAFDk3STfccIN76aWX3MjIiEskEq69vT237ezZsy4ej7tdu3aN+/7S6bTTxXdNXSwKI1akI8RjIgaD8YPhxj+c5/CoI2r/ltPp9BVf8yf8N6ELFy5oz549Gh4eVkNDg/r6+pRKpdTU1JTbJwgCLVu2TIcPH77k/WSzWWUymbwBACgP3iHU29ur66+/XkEQaN26ddq3b59uu+02pVIpSVJ1dXXe/tXV1bltY2lra1M8Hs+N2tpa35IAAEXKO4RuvfVWnThxQkeOHNETTzyhlpYWffjhh7ntsVj+JX/OuVG3fd+WLVuUTqdzo7+/37ckAECR8v6c0IwZM3TzzTdLkhYtWqSenh49//zz+s1vfiNJSqVSSiaTuf0HBwdHnR19XxAECoLAtwwAQAmY9OeEnHPKZrOqr69XIpFQZ2dnbtu5c+fU3d2txsbGyT4MAKAEeZ0JPfPMM2publZtba2Ghoa0Z88edXV16e2331YsFtOmTZu0bds2zZs3T/PmzdO2bdt07bXX6pFHHgmrfgBAEfMKof/973969NFHNTAwoHg8rjvvvFNvv/22Vq5cKUl6+umn9e233+rXv/61vvzySy1evFjvvvuuKioqQil+SjiPfe07YPx/IdYSZkugKInS0kflkPvOMyp1h8/jyHgeRK/di3CBYu7ideiRkclkFI/HJUXrNX1ciq7gCYrUMyY8hNBoRfgaV/TCDKGwX/3T6bQqKysvuw+94wAAZgghAIAZQggAYIYQAgCYIYQAAGYIIQCAGUIIAGCGEAIAmCGEAABmvLtoh+37DRyK7tPWRVcwCqVclr5c5hklXsc8Ygs0noY8kTsTGhoasi4BAFAA43k9j1zvuJGREX3++eeqqKjI+zK8TCaj2tpa9ff3X7EXUTFjnqWjHOYoMc9SU4h5Ouc0NDSkmpoaTZt2+XOdyL0dN23aNM2dO/eS2ysrK0v6CfAd5lk6ymGOEvMsNZOd53eNqK8kcm/HAQDKByEEADBTNCEUBIG2bt2qIAisSwkV8ywd5TBHiXmWmqmeZ+QuTAAAlI+iORMCAJQeQggAYIYQAgCYIYQAAGaKJoReeOEF1dfX65prrtHChQv13nvvWZdUUK2trYrFYnkjkUhYlzUphw4d0qpVq1RTU6NYLKbXX389b7tzTq2traqpqdHMmTO1fPlynTx50qbYSbjSPB977LFRa7tkyRKbYieora1Nd999tyoqKlRVVaU1a9bo448/ztunFNZzPPMshfXcuXOn7rzzztwHUhsaGvTWW2/ltk/lWhZFCO3du1ebNm3Ss88+q+PHj+vee+9Vc3OzTp8+bV1aQd1+++0aGBjIjd7eXuuSJmV4eFgLFixQR0fHmNu3b9+uHTt2qKOjQz09PUokElq5cmXR9Q+80jwl6f77789b2/37909hhZPX3d2t9evX68iRI+rs7NT58+fV1NSk4eHh3D6lsJ7jmadU/Os5d+5ctbe36+jRozp69KhWrFih1atX54JmStfSFYGf/vSnbt26dXm3/fjHP3a//e1vjSoqvK1bt7oFCxZYlxEaSW7fvn25n0dGRlwikXDt7e25286ePevi8bjbtWuXQYWF8cN5OudcS0uLW716tUk9YRkcHHSSXHd3t3OudNfzh/N0rjTX0znnbrjhBvfSSy9N+VpG/kzo3LlzOnbsmJqamvJub2pq0uHDh42qCsepU6dUU1Oj+vp6PfTQQ/r000+tSwpNX1+fUqlU3roGQaBly5aV3LpKUldXl6qqqnTLLbfo8ccf1+DgoHVJk5JOpyVJs2bNklS66/nDeX6nlNbzwoUL2rNnj4aHh9XQ0DDlaxn5EPriiy904cIFVVdX591eXV2tVCplVFXhLV68WC+//LLeeecdvfjii0qlUmpsbNSZM2esSwvFd2tX6usqSc3NzXrllVd04MABPffcc+rp6dGKFSuUzWatS5sQ55w2b96se+65R/Pnz5dUmus51jyl0lnP3t5eXX/99QqCQOvWrdO+fft02223TflaRq6L9qV8/2sdpItPkB/eVsyam5tz/33HHXeooaFBN910k/7yl79o8+bNhpWFq9TXVZIefPDB3H/Pnz9fixYtUl1dnd58802tXbvWsLKJ2bBhgz744AO9//77o7aV0npeap6lsp633nqrTpw4oa+++kp///vf1dLSou7u7tz2qVrLyJ8JzZ49W1ddddWoBB4cHByV1KXkuuuu0x133KFTp05ZlxKK7678K7d1laRkMqm6urqiXNuNGzfqjTfe0MGDB/O+cqXU1vNS8xxLsa7njBkzdPPNN2vRokVqa2vTggUL9Pzzz0/5WkY+hGbMmKGFCxeqs7Mz7/bOzk41NjYaVRW+bDarjz76SMlk0rqUUNTX1yuRSOSt67lz59Td3V3S6ypJZ86cUX9/f1GtrXNOGzZs0GuvvaYDBw6ovr4+b3uprOeV5jmWYlzPsTjnlM1mp34tC36pQwj27Nnjpk+f7v785z+7Dz/80G3atMldd9117rPPPrMurWCefPJJ19XV5T799FN35MgR9/Of/9xVVFQU9RyHhobc8ePH3fHjx50kt2PHDnf8+HH3n//8xznnXHt7u4vH4+61115zvb297uGHH3bJZNJlMhnjyv1cbp5DQ0PuySefdIcPH3Z9fX3u4MGDrqGhwf3oRz8qqnk+8cQTLh6Pu66uLjcwMJAb33zzTW6fUljPK82zVNZzy5Yt7tChQ66vr8998MEH7plnnnHTpk1z7777rnNuateyKELIOef++Mc/urq6Ojdjxgx311135V0yWQoefPBBl0wm3fTp011NTY1bu3atO3nypHVZk3Lw4EEnadRoaWlxzl28rHfr1q0ukUi4IAjc0qVLXW9vr23RE3C5eX7zzTeuqanJzZkzx02fPt3deOONrqWlxZ0+fdq6bC9jzU+S2717d26fUljPK82zVNbzV7/6Ve71dM6cOe5nP/tZLoCcm9q15KscAABmIv83IQBA6SKEAABmCCEAgBlCCABghhACAJghhAAAZgghAIAZQggAYIYQAgCYIYQAAGYIIQCAGUIIAGDm/wC0uTlc3Ra95gAAAABJRU5ErkJggg==",
      "text/plain": [
       "<Figure size 640x480 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "plt.imshow(X_train[0].astype('uint8'))\n",
    "num_classes = len(np.unique(y_train))\n",
    "X_train.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "29d7a75d-6f27-4397-8ee7-83cdbc76457b",
   "metadata": {},
   "outputs": [],
   "source": [
    "X_train = X_train.astype('float32')\n",
    "X_test = X_test.astype('float32')\n",
    "\n",
    "#force the pixel values to have values in the normalized range of [0,1] ensuring that all\n",
    "#pixels contribute equally to the model\n",
    "X_train /= 255\n",
    "X_test /= 255\n",
    "\n",
    "#standardize the pixel values for each RGB color channels for model optimization\n",
    "#helping the gradient to converge faster\n",
    "#implying removing the effect of RGB values from the value of each color and\n",
    "#forcing each channel to have a near zero mean and unit variance \n",
    "mean = X_train.mean(axis=(0,1,2))\n",
    "std = X_train.std(axis=(0,1,2))\n",
    "\n",
    "for i in range(3): \n",
    "    X_train[..., i] = (X_train[..., i] - mean[i]) / std[i] \n",
    "    X_test[..., i] = (X_test[..., i] - mean[i]) / std[i]"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "c81bb2b0",
   "metadata": {},
   "source": [
    "## 2. Algorithm design and setup"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "0c873320",
   "metadata": {},
   "source": [
    "### Algorithm of choice from first six weeks of course"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "b895ee03",
   "metadata": {},
   "source": [
    "### Fully connected neural network"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 77,
   "id": "5d27673f-73f2-49a8-987a-749e060df78e",
   "metadata": {},
   "outputs": [],
   "source": [
    "def mlp_architecture():\n",
    "    model = keras.Sequential([\n",
    "        keras.layers.Flatten(input_shape=(32,32,3)),\n",
    "        keras.layers.Dense(1024, activation='relu'),\n",
    "        keras.layers.Dropout(0.3),\n",
    "        keras.layers.Dense(512, activation='relu'),\n",
    "        keras.layers.Dropout(0.3),\n",
    "        keras.layers.Dense(10, activation='softmax')\n",
    "    ])\n",
    "\n",
    "    model.compile(\n",
    "        optimizer=keras.optimizers.SGD(learning_rate=5e-2),\n",
    "        loss='sparse_categorical_crossentropy',\n",
    "        metrics=['accuracy']\n",
    "    )\n",
    "    return model"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 80,
   "id": "f4d2b753-35e3-407d-b1a8-204ec828031c",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "C:\\Anaconda\\Lib\\site-packages\\keras\\src\\layers\\reshaping\\flatten.py:37: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.\n",
      "  super().__init__(**kwargs)\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Epoch 1/50\n",
      "\u001b[1m313/313\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m4s\u001b[0m 11ms/step - accuracy: 0.3032 - loss: 2.0288 - val_accuracy: 0.3826 - val_loss: 1.6935\n",
      "Epoch 2/50\n",
      "\u001b[1m313/313\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m3s\u001b[0m 10ms/step - accuracy: 0.4213 - loss: 1.6291 - val_accuracy: 0.4450 - val_loss: 1.5591\n",
      "Epoch 3/50\n",
      "\u001b[1m313/313\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m3s\u001b[0m 11ms/step - accuracy: 0.4595 - loss: 1.5311 - val_accuracy: 0.4791 - val_loss: 1.4915\n",
      "Epoch 4/50\n",
      "\u001b[1m313/313\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m3s\u001b[0m 11ms/step - accuracy: 0.4786 - loss: 1.4687 - val_accuracy: 0.4608 - val_loss: 1.5228\n",
      "Epoch 5/50\n",
      "\u001b[1m313/313\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m3s\u001b[0m 10ms/step - accuracy: 0.5002 - loss: 1.4217 - val_accuracy: 0.4858 - val_loss: 1.4520\n",
      "Epoch 6/50\n",
      "\u001b[1m313/313\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m3s\u001b[0m 10ms/step - accuracy: 0.5154 - loss: 1.3779 - val_accuracy: 0.4950 - val_loss: 1.4299\n",
      "Epoch 7/50\n",
      "\u001b[1m313/313\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m3s\u001b[0m 10ms/step - accuracy: 0.5286 - loss: 1.3259 - val_accuracy: 0.4838 - val_loss: 1.4537\n",
      "Epoch 8/50\n",
      "\u001b[1m313/313\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m4s\u001b[0m 11ms/step - accuracy: 0.5473 - loss: 1.2909 - val_accuracy: 0.5091 - val_loss: 1.4111\n",
      "Epoch 9/50\n",
      "\u001b[1m313/313\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m3s\u001b[0m 10ms/step - accuracy: 0.5611 - loss: 1.2446 - val_accuracy: 0.5250 - val_loss: 1.3685\n",
      "Epoch 10/50\n",
      "\u001b[1m313/313\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m3s\u001b[0m 11ms/step - accuracy: 0.5704 - loss: 1.2235 - val_accuracy: 0.5175 - val_loss: 1.3830\n",
      "Epoch 11/50\n",
      "\u001b[1m313/313\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m3s\u001b[0m 10ms/step - accuracy: 0.5807 - loss: 1.1857 - val_accuracy: 0.5187 - val_loss: 1.3719\n",
      "Epoch 12/50\n",
      "\u001b[1m313/313\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m3s\u001b[0m 11ms/step - accuracy: 0.5858 - loss: 1.1666 - val_accuracy: 0.5298 - val_loss: 1.3556\n",
      "Epoch 13/50\n",
      "\u001b[1m313/313\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m3s\u001b[0m 11ms/step - accuracy: 0.5990 - loss: 1.1370 - val_accuracy: 0.5399 - val_loss: 1.3315\n",
      "Epoch 14/50\n",
      "\u001b[1m313/313\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m3s\u001b[0m 11ms/step - accuracy: 0.6079 - loss: 1.1053 - val_accuracy: 0.5392 - val_loss: 1.3428\n",
      "Epoch 15/50\n",
      "\u001b[1m313/313\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m3s\u001b[0m 10ms/step - accuracy: 0.6209 - loss: 1.0782 - val_accuracy: 0.5422 - val_loss: 1.3368\n",
      "Epoch 16/50\n",
      "\u001b[1m313/313\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m3s\u001b[0m 11ms/step - accuracy: 0.6251 - loss: 1.0494 - val_accuracy: 0.5404 - val_loss: 1.3412\n",
      "Epoch 17/50\n",
      "\u001b[1m313/313\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m3s\u001b[0m 10ms/step - accuracy: 0.6395 - loss: 1.0235 - val_accuracy: 0.5455 - val_loss: 1.3259\n",
      "Epoch 18/50\n",
      "\u001b[1m313/313\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m3s\u001b[0m 10ms/step - accuracy: 0.6390 - loss: 1.0093 - val_accuracy: 0.5330 - val_loss: 1.3763\n",
      "Epoch 19/50\n",
      "\u001b[1m313/313\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m3s\u001b[0m 11ms/step - accuracy: 0.6565 - loss: 0.9783 - val_accuracy: 0.5417 - val_loss: 1.3445\n",
      "Epoch 20/50\n",
      "\u001b[1m313/313\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m3s\u001b[0m 11ms/step - accuracy: 0.6600 - loss: 0.9598 - val_accuracy: 0.5537 - val_loss: 1.3343\n",
      "Epoch 21/50\n",
      "\u001b[1m313/313\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m3s\u001b[0m 10ms/step - accuracy: 0.6620 - loss: 0.9450 - val_accuracy: 0.5473 - val_loss: 1.3437\n",
      "Epoch 22/50\n",
      "\u001b[1m313/313\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m3s\u001b[0m 11ms/step - accuracy: 0.6765 - loss: 0.9015 - val_accuracy: 0.5477 - val_loss: 1.3380\n",
      "Epoch 23/50\n",
      "\u001b[1m313/313\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m3s\u001b[0m 10ms/step - accuracy: 0.6890 - loss: 0.8817 - val_accuracy: 0.5398 - val_loss: 1.3680\n",
      "Epoch 24/50\n",
      "\u001b[1m313/313\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m3s\u001b[0m 11ms/step - accuracy: 0.6936 - loss: 0.8579 - val_accuracy: 0.5464 - val_loss: 1.3422\n",
      "Epoch 25/50\n",
      "\u001b[1m313/313\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m3s\u001b[0m 10ms/step - accuracy: 0.7034 - loss: 0.8400 - val_accuracy: 0.5511 - val_loss: 1.3393\n",
      "Epoch 26/50\n",
      "\u001b[1m313/313\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m3s\u001b[0m 10ms/step - accuracy: 0.7018 - loss: 0.8429 - val_accuracy: 0.5379 - val_loss: 1.3717\n",
      "Epoch 27/50\n",
      "\u001b[1m313/313\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m3s\u001b[0m 10ms/step - accuracy: 0.7125 - loss: 0.8116 - val_accuracy: 0.5531 - val_loss: 1.3371\n",
      "Epoch 28/50\n",
      "\u001b[1m313/313\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m3s\u001b[0m 11ms/step - accuracy: 0.7281 - loss: 0.7790 - val_accuracy: 0.5458 - val_loss: 1.3754\n",
      "Epoch 29/50\n",
      "\u001b[1m313/313\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m3s\u001b[0m 11ms/step - accuracy: 0.7291 - loss: 0.7659 - val_accuracy: 0.5450 - val_loss: 1.3872\n",
      "Epoch 30/50\n",
      "\u001b[1m313/313\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m3s\u001b[0m 10ms/step - accuracy: 0.7326 - loss: 0.7534 - val_accuracy: 0.5448 - val_loss: 1.3773\n",
      "Epoch 31/50\n",
      "\u001b[1m313/313\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m3s\u001b[0m 11ms/step - accuracy: 0.7360 - loss: 0.7432 - val_accuracy: 0.5450 - val_loss: 1.3967\n",
      "Epoch 32/50\n",
      "\u001b[1m313/313\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m3s\u001b[0m 11ms/step - accuracy: 0.7439 - loss: 0.7210 - val_accuracy: 0.5466 - val_loss: 1.3837\n",
      "Epoch 33/50\n",
      "\u001b[1m313/313\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m3s\u001b[0m 11ms/step - accuracy: 0.7495 - loss: 0.7049 - val_accuracy: 0.5532 - val_loss: 1.3866\n",
      "Epoch 34/50\n",
      "\u001b[1m313/313\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m3s\u001b[0m 10ms/step - accuracy: 0.7600 - loss: 0.6775 - val_accuracy: 0.5496 - val_loss: 1.4034\n",
      "Epoch 35/50\n",
      "\u001b[1m313/313\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m3s\u001b[0m 11ms/step - accuracy: 0.7660 - loss: 0.6632 - val_accuracy: 0.5518 - val_loss: 1.3868\n",
      "Epoch 36/50\n",
      "\u001b[1m313/313\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m3s\u001b[0m 11ms/step - accuracy: 0.7708 - loss: 0.6540 - val_accuracy: 0.5251 - val_loss: 1.5000\n",
      "Epoch 37/50\n",
      "\u001b[1m313/313\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m4s\u001b[0m 11ms/step - accuracy: 0.7729 - loss: 0.6411 - val_accuracy: 0.5603 - val_loss: 1.3981\n",
      "Epoch 38/50\n",
      "\u001b[1m313/313\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m3s\u001b[0m 11ms/step - accuracy: 0.7775 - loss: 0.6327 - val_accuracy: 0.5444 - val_loss: 1.4399\n",
      "Epoch 39/50\n",
      "\u001b[1m313/313\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m3s\u001b[0m 10ms/step - accuracy: 0.7784 - loss: 0.6189 - val_accuracy: 0.5537 - val_loss: 1.4212\n",
      "Epoch 40/50\n",
      "\u001b[1m313/313\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m3s\u001b[0m 11ms/step - accuracy: 0.7850 - loss: 0.6084 - val_accuracy: 0.5523 - val_loss: 1.4380\n",
      "Epoch 41/50\n",
      "\u001b[1m313/313\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m3s\u001b[0m 11ms/step - accuracy: 0.7936 - loss: 0.5861 - val_accuracy: 0.5615 - val_loss: 1.4155\n",
      "Epoch 42/50\n",
      "\u001b[1m313/313\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m3s\u001b[0m 11ms/step - accuracy: 0.8015 - loss: 0.5701 - val_accuracy: 0.5506 - val_loss: 1.4452\n",
      "Epoch 43/50\n",
      "\u001b[1m313/313\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m3s\u001b[0m 10ms/step - accuracy: 0.8034 - loss: 0.5637 - val_accuracy: 0.5517 - val_loss: 1.4788\n",
      "Epoch 44/50\n",
      "\u001b[1m313/313\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m3s\u001b[0m 11ms/step - accuracy: 0.8010 - loss: 0.5615 - val_accuracy: 0.5496 - val_loss: 1.5323\n",
      "Epoch 45/50\n",
      "\u001b[1m313/313\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m3s\u001b[0m 11ms/step - accuracy: 0.8076 - loss: 0.5435 - val_accuracy: 0.5502 - val_loss: 1.4986\n",
      "Epoch 46/50\n",
      "\u001b[1m313/313\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m3s\u001b[0m 11ms/step - accuracy: 0.8125 - loss: 0.5320 - val_accuracy: 0.5572 - val_loss: 1.5277\n",
      "Epoch 47/50\n",
      "\u001b[1m313/313\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m3s\u001b[0m 11ms/step - accuracy: 0.8168 - loss: 0.5284 - val_accuracy: 0.5573 - val_loss: 1.4907\n",
      "Epoch 48/50\n",
      "\u001b[1m313/313\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m3s\u001b[0m 11ms/step - accuracy: 0.8202 - loss: 0.5111 - val_accuracy: 0.5575 - val_loss: 1.4815\n",
      "Epoch 49/50\n",
      "\u001b[1m313/313\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m3s\u001b[0m 11ms/step - accuracy: 0.8275 - loss: 0.4903 - val_accuracy: 0.5497 - val_loss: 1.5498\n",
      "Epoch 50/50\n",
      "\u001b[1m313/313\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m3s\u001b[0m 11ms/step - accuracy: 0.8229 - loss: 0.5043 - val_accuracy: 0.5591 - val_loss: 1.5198\n"
     ]
    }
   ],
   "source": [
    "model = mlp_architecture()\n",
    "history = model.fit(\n",
    "    X_train, y_train,\n",
    "    epochs = 50, \n",
    "    validation_split=0.2,\n",
    "    batch_size=128\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 81,
   "id": "9303a14e-2b3b-4b75-964e-e5b3bad131ee",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAAp8AAAHACAYAAADk2AO3AAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjguMCwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy81sbWrAAAACXBIWXMAAA9hAAAPYQGoP6dpAABw1UlEQVR4nO3dd3hUVeLG8e9MeocQ0iDU0KsQehUEBcVeQMWGBbGx2Ne1F9Tfih1WsSuWde2ISlQEBBFEEKT3UAJJKKkkmWTu74+TBEICJCHJZCbv53nmmZl778w9k5Py5rRrsyzLQkRERESkFthdXQARERERqT8UPkVERESk1ih8ioiIiEitUfgUERERkVqj8CkiIiIitUbhU0RERERqjcKniIiIiNQahU8RERERqTXeri5ARTidTvbs2UNISAg2m83VxRERERGRY1iWRWZmJrGxsdjtx2/fdIvwuWfPHuLi4lxdDBERERE5iZ07d9K0adPj7neL8BkSEgKYDxMaGlrj53M4HMydO5eRI0fi4+NT4+eTmqO69ByqS8+huvQcqkvPUR11mZGRQVxcXEluOx63CJ/FXe2hoaG1Fj4DAwMJDQ3VD5ObU116DtWl51Bdeg7Vpeeozro82RBJTTgSERERkVqj8CkiIiIitUbhU0RERERqjVuM+awIy7IoKCigsLDwlN/L4XDg7e1Nbm5utbyfuM6xdenj44OXl5eriyUiIlJveUT4zM/PJzk5mZycnGp5P8uyiI6OZufOnVpX1M0dW5c2m42mTZsSHBzs6qKJiIjUS24fPp1OJ9u2bcPLy4vY2Fh8fX1POTA6nU6ysrIIDg4+4SKpUvcdXZc2m43U1FR27dpFmzZt1AIqIiLiAm4fPvPz83E6ncTFxREYGFgt7+l0OsnPz8ff31/h080dW5eNGzdm+/btOBwOhU8REREX8JhkpZAoFaFhFCIiIq6lxCYiIiIitUbhU0RERERqjcKniIiIiNQahU8p4XA4XF0EERER8XAKny70/fffM3DgQBo0aECjRo0455xz2LJlS8n+Xbt2MXbsWMLDwwkKCiIhIYHff/+9ZP/XX39NQkIC/v7+REREcOGFF5bss9lsfPnll6XO16BBA9555x0Atm/fjs1m47///S9Dhw7F39+fDz74gP379zNu3DiaNm1KYGAgXbp04aOPPir1Pk6nk2eeeYb4+Hj8/Pxo1qwZTz75JADDhg3j1ltvLXX8/v378fPz4+eff66OL5uIiIi4MbdfaulYlmVx2HFqVyVyOp0czi/EO7+gUrPoA3y8KjWbOjs7mylTptClSxeys7N56KGHuOCCC1i5ciU5OTkMGTKEJk2a8PXXXxMdHc2ff/6J0+kE4Ntvv+XCCy/kgQce4P333yc/P59vv/220p/13nvv5bnnnuPtt9/Gz8+P3Nxcevbsyb333ktoaCjffvst48ePp1WrVvTp0weA+++/n5kzZ/L8888zcOBAkpOTWb9+PQDXX389t956K8899xx+fn4AzJo1i9jYWE4//fRKl09ERERg7Z4M3l60jQ37MgkL8CEswIeGgb40CPShQaAvDQN9Sh43KNoXGuCDl73urfLiceHzsKOQjg/94JJzr33sTAJ9K/4lveiii0o9f/PNN4mMjGTt2rUsXryY1NRUli1bRnh4OADx8fElxz755JOMHTuWRx99tGRbt27dKl3myZMnl2oxBbjrrrtKHt922218//33fPrpp/Tp04fMzExefPFFXnnlFa6++moAWrduzcCBA0s+02233cZXX33FpZdeCsDbb7/NNddco2WOREREKsHptJi/MZU3ft3Kos37K/16mw2GtYvkzWt61UDpqs7jwqc72bJlCw8++CBLliwhLS2tpFUzKSmJlStXctppp5UEz2OtXLmSG2644ZTLkJCQUOp5YWEhTz/9NJ988gm7d+8mLy+PvLw8goKCAFi3bh15eXkMHz683Pfz8/Pjyiuv5K233uLSSy9l5cqV/PXXX2WGAIiIiEj5ch2FfP7nbt78dStbUrMB8LLbGNU5mrO7xHDYUcjBHAfpOfkczHFw6LCDQzn5HMpxcOhwPoeyHWTmFWBZ4ONV90ZYelz4DPDxYu1jZ57SezidTjIzMgkJDal0t3tljBkzhri4OGbOnElsbCxOp5POnTuTn59PQEDAic91kv02mw3LskptK29CUXGoLPbcc8/x/PPP88ILL9ClSxeCgoKYPHky+fn5FTovmK737t27s2vXLt566y2GDx9O8+bNT/o6ERGR+iw1M4/3l+zggyU7OJBt/u4G+3kztlcc1wxoQdOGFb+So6PQSfphB85jskBd4HHh02azVarruzxOp5MCXy8Cfb1r7MpJ+/fvZ926dbz22msMGjQIgF9//bVkf9eu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uOCCCwDIysoqmbxTWX/88QcFBQU899xzJUHxv//9b6ljunbtyk8//VTu+qpt2rQhICCAn376qdzLojZu3BgwQy4aNmwImBbLili4cCHTp09n9OjRAOzcuZO0tLRS5dq1axcbN248buvnlVdeyT333MNLL73EmjVrSoYGiIhI9bIsiwWb0vjPL1v4bev+oq02ujUNY2zvZpzTNYYQf61gICem8OliV1xxBWPGjGHNmjVceeWVJdvj4+P5/PPPGTNmDDabjQcffLDKk2dat25NQUEBL7/8MmPGjGHRokX85z//KXXM/fffT5cuXZg0aRITJ07E19eXefPmcckllxAREcG9997LPffcg6+vLwMGDCA1NZU1a9YwYcIE4uPjiYuL45FHHuGJJ55g06ZNPPfccxUqW3x8PO+//z4JCQlkZGRw9913l2rtHDJkCIMHD+aiiy5i2rRpxMfHs379emw2G2eddRYADRs25MILL+Tuu+9m5MiRNG3atEpfJxERKV9BoZNvVyfz2vytrE02azl6222c0yWattZObrikj5bNkgrTqF8XGzZsGOHh4WzYsIHLL7+8ZPvzzz9Pw4YN6d+/P2PGjOHMM8+kR48eVTpH9+7dmTZtGs888wydO3dm1qxZTJ06tdQxbdu2Ze7cufz111/07t2bfv368dVXX+Htbf4/efDBB7nzzjt56KGH6NChA5dddhkpKSmAWdfro48+Yv369XTr1o1nnnmGJ554okJle+uttzh48CCnnXYa48eP5/bbbycyMrLUMZ999hm9evVi3LhxdOzYkXvuuadkFn6xCRMmkJ+fz3XXXVelr5GIiJR1OL+QdxdvZ+i/f+GOj1eyNjmDQF8vrhvQkvn3nM7/XdyFJqc40k3qH5tVI4ttVq+MjAzCwsJIT08v9wpH27Zto2XLltV2xRqn00lGRgahoaFuuYB7fTRr1izuuOMO9uzZg6+vb8n2Y+uyJr5fpHY4HA7mzJnD6NGj1cLi5lSXdd/B7Hze/W077y7ezsEcM4a/UZAv1/Rvwfh+zWkQaH7Pqi49R3XU5Yny2tHU7S5uLScnh23btjF16lRuuummUsFTREQqrqDQyZ9Jh5izOplPlu3ksMP0MMWFB3DjoFZckhCHv4/W45RTp/DpAWbNmsVNN91U7r7mzZuzZs2aWi5R7Xn22Wd58sknGTx4MPfff7+r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V19tWZZZQuLhhx+2oqOjLT8/P2vw4MHW6tWrXVtoKaO8OgSst99+u+QY1aV7uO6660p+lzZu3NgaPnx4SfC0LNWjuzs2fKo+3cNll11mxcTEWD4+PlZsbKx14YUXWmvWrCnZX1v1aLMsy6retlQRERERkfJpzKeIiIiI1BqFTxERERGpNQqfIiIiIlJrFD5FREREpNYofIqIiIhIrVH4FBEREZFao/ApIiIiIrVG4VNExI3YbDa+/PJLVxdDRKTKFD5FRCrommuuwWazlbmdddZZri6aiIjb8HZ1AURE3MlZZ53F22+/XWqbn5+fi0ojIuJ+1PIpIlIJfn5+REdHl7o1bNgQMF3iM2bMYNSoUQQEBNCyZUs+/fTTUq9fvXo1w4YNIyAggEaNGnHjjTeSlZVV6pi33nqLTp064efnR0xMDLfeemup/WlpaVxwwQUEBgbSpk0bvv7665r90CIi1UjhU0SkGj344INcdNFF/PXXX1x55ZWMGzeOdevWAZCTk8NZZ51Fw4YNWbZsGZ9++ik//vhjqXA5Y8YMbrnlFm688UZWr17N119/TXx8fKlzPProo1x66aWsWrWK0aNHc8UVV3DgwIFa/ZwiIlVlsyzLcnUhRETcwTXXXMMHH3yAv79/qe333nsvDz74IDabjYkTJzJjxoySfX379qVHjx5Mnz6dmTNncu+997Jz506CgoIAmDNnDmPGjGHPnj1ERUXRpEkTrr32Wp544olyy2Cz2fjXv/7F448/DkB2djYhISHMmTNHY09FxC1ozKeISCWcfvrppcIlQHh4eMnjfv36ldrXr18/Vq5cCcC6devo1q1bSfAEGDBgAE6nkw0bNmCz2dizZw/Dhw8/YRm6du1a8jgoKIiQkBBSUlKq+pFERGqVwqeISCUEBQWV6QY/GZvNBoBlWSWPyzsmICCgQu/n4+NT5rVOp7NSZRIRcRWN+RQRqUZLliwp87x9+/YAdOzYkZUrV5KdnV2yf9GiRdjtdtq2bUtISAgtWrTgp59+qtUyi4jUJrV8iohUQl5eHnv37i21zdvbm4iICAA+/fRTEhISGDhwILNmzWLp0qW8+eabAFxxxRU8/PDDXH311TzyyCOkpqZy2223MX78eKKiogB45JFHmDhxIpGRkYwaNYrMzEwWLVrEbbfdVrsfVESkhih8iohUwvfff09MTEypbe3atWP9+vWAmYn+8ccfM2nSJKKjo5k1axYdO3YEIDAwkB9++IE77riDXr16ERgYyEUXXcS0adNK3uvqq68mNzeX559/nrvuuouIiAguvvji2vuAIiI1TLPdRUSqic1m44svvuD88893dVFEROosjfkUERERkVqj8CkiIiIitUZjPkVEqolGMYmInJxaPkVERESk1ih8ioiIiEitUfgUERERkVqj8CkiIiIitUbhU0RERERqjcKniIiIiNQahU8RERERqTUKnyIiIiJSaxQ+RURERKTW/D/V/hPDjNqZ5AAAAABJRU5ErkJggg==",
      "text/plain": [
       "<Figure size 800x500 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "import pandas as pd\n",
    "\n",
    "# Convert the history dictionary to a Pandas dataframe and extract the accuracies\n",
    "accuracies = pd.DataFrame(history.history)[['accuracy', 'val_accuracy']]\n",
    "\n",
    "# Plot the accuracies\n",
    "accuracies.plot(figsize=(8, 5))\n",
    "plt.grid(True)\n",
    "plt.gca()\n",
    "plt.xlabel('Epoch')\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "63aa570f",
   "metadata": {},
   "source": [
    "### Convolutional neural network"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "3b4911b1",
   "metadata": {},
   "source": [
    "## 3. Hyperparameter tuning"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "71085600",
   "metadata": {},
   "source": [
    "### Algorithm of choice from first six weeks of course"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "08d2d615",
   "metadata": {},
   "source": [
    "### Fully connected neural network"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 136,
   "id": "286ecd24-ecc2-4489-9478-f23c5b295b9a",
   "metadata": {},
   "outputs": [],
   "source": [
    "def mlp_classifier(hp):\n",
    "    model = keras.Sequential()\n",
    "    model.add(keras.layers.Flatten(input_shape=(32,32,3)))\n",
    "\n",
    "    layer_cnt = hp.Choice('layer_cnt', values=[2,3,4,5,6])\n",
    "    dropout = hp.Float(\"dropout\", min_value=0.1, max_value=0.5, step=0.1)\n",
    "    for i in range(layer_cnt):\n",
    "        model.add(\n",
    "            keras.layers.Dense(\n",
    "                units=hp.Choice(f'node_{i}', values=[1024, 512, 256, 128]), \n",
    "                activation=hp.Choice(f'activation_{i}', values=['relu', 'tanh', 'sigmoid'])\n",
    "            )\n",
    "        )\n",
    "        model.add(keras.layers.Dropout(dropout))\n",
    "    model.add(keras.layers.Dense(10, activation='softmax'))\n",
    "    learning_rate = hp.Choice('learning_rate', values=[1e-2, 1e-3, 1e-4])\n",
    "    optimizer_name = hp.Choice('optimizer_type', values=['Adam', 'SGD'])\n",
    "    if optimizer_name == 'Adam':\n",
    "        opt = keras.optimizers.Adam(learning_rate=learning_rate)\n",
    "    elif optimizer_name == 'SGD':\n",
    "        opt = keras.optimizers.SGD(learning_rate=learning_rate)\n",
    "        \n",
    "    model.compile(optimizer=opt,\n",
    "                  loss='sparse_categorical_crossentropy',\n",
    "                  metrics=['accuracy']\n",
    "                 )\n",
    "    return model"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 137,
   "id": "17459da4-21a3-4d38-a849-b8a40844d685",
   "metadata": {},
   "outputs": [],
   "source": [
    "tuner = BayesianOptimization(\n",
    "    hypermodel=mlp_classifier,\n",
    "    objective=\"val_accuracy\",\n",
    "    max_trials=10,\n",
    "    seed=0,\n",
    "    max_retries_per_trial=2,\n",
    "    max_consecutive_failed_trials=3,\n",
    "    overwrite=True\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 138,
   "id": "7e3f3c38-c307-4aff-a824-e1398a8d5647",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Trial 10 Complete [00h 00m 43s]\n",
      "val_accuracy: 0.12060000002384186\n",
      "\n",
      "Best val_accuracy So Far: 0.5142999887466431\n",
      "Total elapsed time: 00h 12m 13s\n"
     ]
    }
   ],
   "source": [
    "tuner.search(\n",
    "    X_train, \n",
    "    y_train, \n",
    "    epochs=30, \n",
    "    validation_split=0.2,\n",
    "    batch_size=512\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 139,
   "id": "70f918ef-686c-43c0-83db-fd155ad2bb7b",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "===== Trial ID: 07 =====\n",
      "Hyperparameters: {'layer_cnt': 6, 'dropout': 0.30000000000000004, 'node_0': 1024, 'activation_0': 'relu', 'node_1': 512, 'activation_1': 'sigmoid', 'learning_rate': 0.001, 'optimizer_type': 'Adam', 'node_2': 128, 'activation_2': 'sigmoid', 'node_3': 512, 'activation_3': 'sigmoid', 'node_4': 1024, 'activation_4': 'relu', 'node_5': 512, 'activation_5': 'relu'}\n",
      "Epoch | loss         | accuracy     | val_loss     | val_accuracy\n",
      "-----------------------------------------------------------------\n",
      "1     |       1.0821 |       0.6129 |       1.4412 |       0.5143 | \n",
      "=====================================================================\n",
      "\n",
      "===== Trial ID: 02 =====\n",
      "Hyperparameters: {'layer_cnt': 6, 'dropout': 0.5, 'node_0': 1024, 'activation_0': 'sigmoid', 'node_1': 512, 'activation_1': 'tanh', 'learning_rate': 0.001, 'optimizer_type': 'Adam', 'node_2': 1024, 'activation_2': 'relu', 'node_3': 1024, 'activation_3': 'relu', 'node_4': 1024, 'activation_4': 'relu', 'node_5': 1024, 'activation_5': 'relu'}\n",
      "Epoch | loss         | accuracy     | val_loss     | val_accuracy\n",
      "-----------------------------------------------------------------\n",
      "1     |       1.5781 |       0.4445 |       1.5358 |       0.4641 | \n",
      "=====================================================================\n",
      "\n",
      "===== Trial ID: 08 =====\n",
      "Hyperparameters: {'layer_cnt': 3, 'dropout': 0.5, 'node_0': 256, 'activation_0': 'sigmoid', 'node_1': 128, 'activation_1': 'sigmoid', 'learning_rate': 0.001, 'optimizer_type': 'Adam', 'node_2': 128, 'activation_2': 'relu', 'node_3': 1024, 'activation_3': 'sigmoid', 'node_4': 1024, 'activation_4': 'relu', 'node_5': 512, 'activation_5': 'relu'}\n",
      "Epoch | loss         | accuracy     | val_loss     | val_accuracy\n",
      "-----------------------------------------------------------------\n",
      "1     |       1.5411 |       0.4518 |       1.5118 |       0.4617 | \n",
      "=====================================================================\n",
      "\n",
      "===== Trial ID: 00 =====\n",
      "Hyperparameters: {'layer_cnt': 2, 'dropout': 0.4, 'node_0': 128, 'activation_0': 'relu', 'node_1': 128, 'activation_1': 'sigmoid', 'learning_rate': 0.01, 'optimizer_type': 'Adam'}\n",
      "Epoch | loss         | accuracy     | val_loss     | val_accuracy\n",
      "-----------------------------------------------------------------\n",
      "1     |       1.8428 |       0.3307 |       1.7379 |       0.3750 | \n",
      "=====================================================================\n",
      "\n",
      "===== Trial ID: 01 =====\n",
      "Hyperparameters: {'layer_cnt': 3, 'dropout': 0.2, 'node_0': 1024, 'activation_0': 'tanh', 'node_1': 256, 'activation_1': 'relu', 'learning_rate': 0.0001, 'optimizer_type': 'SGD', 'node_2': 1024, 'activation_2': 'relu'}\n",
      "Epoch | loss         | accuracy     | val_loss     | val_accuracy\n",
      "-----------------------------------------------------------------\n",
      "1     |       2.2029 |       0.1939 |       2.1552 |       0.2299 | \n",
      "=====================================================================\n",
      "\n",
      "===== Trial ID: 04 =====\n",
      "Hyperparameters: {'layer_cnt': 4, 'dropout': 0.4, 'node_0': 1024, 'activation_0': 'relu', 'node_1': 256, 'activation_1': 'relu', 'learning_rate': 0.0001, 'optimizer_type': 'SGD', 'node_2': 256, 'activation_2': 'relu', 'node_3': 256, 'activation_3': 'tanh', 'node_4': 1024, 'activation_4': 'tanh', 'node_5': 256, 'activation_5': 'relu'}\n",
      "Epoch | loss         | accuracy     | val_loss     | val_accuracy\n",
      "-----------------------------------------------------------------\n",
      "1     |       2.5807 |       0.1241 |       2.1970 |       0.1951 | \n",
      "=====================================================================\n",
      "\n",
      "===== Trial ID: 09 =====\n",
      "Hyperparameters: {'layer_cnt': 4, 'dropout': 0.2, 'node_0': 256, 'activation_0': 'tanh', 'node_1': 128, 'activation_1': 'sigmoid', 'learning_rate': 0.0001, 'optimizer_type': 'SGD', 'node_2': 128, 'activation_2': 'relu', 'node_3': 1024, 'activation_3': 'sigmoid', 'node_4': 256, 'activation_4': 'tanh', 'node_5': 512, 'activation_5': 'tanh'}\n",
      "Epoch | loss         | accuracy     | val_loss     | val_accuracy\n",
      "-----------------------------------------------------------------\n",
      "1     |       2.3636 |       0.1025 |       2.3071 |       0.1206 | \n",
      "=====================================================================\n",
      "\n",
      "===== Trial ID: 05 =====\n",
      "Hyperparameters: {'layer_cnt': 6, 'dropout': 0.1, 'node_0': 512, 'activation_0': 'relu', 'node_1': 512, 'activation_1': 'relu', 'learning_rate': 0.0001, 'optimizer_type': 'SGD', 'node_2': 128, 'activation_2': 'tanh', 'node_3': 128, 'activation_3': 'relu', 'node_4': 256, 'activation_4': 'sigmoid', 'node_5': 1024, 'activation_5': 'relu'}\n",
      "Epoch | loss         | accuracy     | val_loss     | val_accuracy\n",
      "-----------------------------------------------------------------\n",
      "1     |       2.3122 |       0.1033 |       2.3020 |       0.1104 | \n",
      "=====================================================================\n",
      "\n",
      "===== Trial ID: 06 =====\n",
      "Hyperparameters: {'layer_cnt': 5, 'dropout': 0.30000000000000004, 'node_0': 128, 'activation_0': 'tanh', 'node_1': 1024, 'activation_1': 'sigmoid', 'learning_rate': 0.01, 'optimizer_type': 'Adam', 'node_2': 256, 'activation_2': 'relu', 'node_3': 1024, 'activation_3': 'tanh', 'node_4': 256, 'activation_4': 'sigmoid', 'node_5': 1024, 'activation_5': 'tanh'}\n",
      "Epoch | loss         | accuracy     | val_loss     | val_accuracy\n",
      "-----------------------------------------------------------------\n",
      "1     |       2.3225 |       0.0992 |       2.3297 |       0.1025 | \n",
      "=====================================================================\n",
      "\n",
      "===== Trial ID: 03 =====\n",
      "Hyperparameters: {'layer_cnt': 6, 'dropout': 0.2, 'node_0': 128, 'activation_0': 'relu', 'node_1': 128, 'activation_1': 'sigmoid', 'learning_rate': 0.0001, 'optimizer_type': 'SGD', 'node_2': 128, 'activation_2': 'sigmoid', 'node_3': 128, 'activation_3': 'sigmoid', 'node_4': 256, 'activation_4': 'relu', 'node_5': 256, 'activation_5': 'sigmoid'}\n",
      "Epoch | loss         | accuracy     | val_loss     | val_accuracy\n",
      "-----------------------------------------------------------------\n",
      "1     |       2.6382 |       0.1005 |       2.5749 |       0.0997 | \n",
      "=====================================================================\n"
     ]
    }
   ],
   "source": [
    "all_trials = tuner.oracle.get_best_trials(num_trials=10)\n",
    "\n",
    "METRICS_TO_EXTRACT = ['loss', 'accuracy', 'val_loss', 'val_accuracy'] \n",
    "\n",
    "for trial in all_trials:\n",
    "    trial_id = trial.trial_id\n",
    "    \n",
    "    print(f\"\\n===== Trial ID: {trial_id} =====\")\n",
    "    print(f\"Hyperparameters: {trial.hyperparameters.values}\")\n",
    "    \n",
    "    trial_history = {}\n",
    "    \n",
    "    for metric_name in METRICS_TO_EXTRACT:\n",
    "        try:\n",
    "            metric_observations = trial.metrics.get_history(metric_name)\n",
    "            metric_values = [v.value[0] for v in metric_observations]\n",
    "            \n",
    "            trial_history[metric_name] = metric_values\n",
    "            \n",
    "        except KeyError:\n",
    "            trial_history[metric_name] = [\"Metric not logged\"]\n",
    "\n",
    "\n",
    "    num_epochs = len(trial_history.get('loss', []))\n",
    "    \n",
    "    if num_epochs > 0:\n",
    "        header = \"Epoch | \" + \" | \".join(f\"{m:<12}\" for m in METRICS_TO_EXTRACT)\n",
    "        print(header)\n",
    "        print(\"-\" * len(header))\n",
    "        for epoch in range(num_epochs):\n",
    "            row = f\"{epoch + 1:<5} | \"\n",
    "            for metric_name in METRICS_TO_EXTRACT:\n",
    "                value = trial_history[metric_name][epoch]\n",
    "                row += f\"{value:12.4f} | \"\n",
    "            print(row)\n",
    "    else:\n",
    "        print(\"No epoch history found for this trial.\")\n",
    "        \n",
    "    print(\"=\" * (len(header) + 4))"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "57c76117",
   "metadata": {},
   "source": [
    "### Convolutional neural network"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "eead5c82",
   "metadata": {},
   "source": [
    "## 4. Final models\n",
    "In this section, please ensure to include cells to train each model with its best hyperparmater combination independently of the hyperparameter tuning cells, i.e. don't rely on the hyperparameter tuning cells having been run."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "e1e56a6c",
   "metadata": {},
   "source": [
    "### Algorithm of choice from first six weeks of course"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "fe676a86",
   "metadata": {},
   "source": [
    "### Fully connected neural network"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "4ffd5d11-00de-47a1-b61c-38abe1fdce26",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f5d21cca-bc7a-41a8-af2b-116e1380d498",
   "metadata": {},
   "outputs": [],
   "source": [
    "hp = {\n",
    "    'layer_cnt': 6, \n",
    "    'dropout': 0.3, \n",
    "    'units': [1024,512,128,512,1024,512] \n",
    "    'activation': ['relu', 'sigmoid', 'sigmoid', 'sigmoid', 'relu', 'relu'], \n",
    "    'learning_rate': 0.001, \n",
    "    'optimizer_name': 'Adam'\n",
    "}"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "5db6af4b-9cc9-4a6f-b007-ef77b61e5550",
   "metadata": {},
   "outputs": [],
   "source": [
    "model = final_mlp_classifer(hp)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b01f47ac-ab32-4174-acc6-d28aa9140aed",
   "metadata": {},
   "outputs": [],
   "source": [
    "y_pred = np.argmax(model.predict(X_test, verbose=0), axis=1)\n",
    "y_true = np.argmax(y_test, axis=1)\n",
    "f1 = f1_score(y_true, y_pred, average='macro')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c94c5c6b-1417-4786-9852-b9c4180bf4f6",
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "\n",
    "# Convert the history dictionary to a Pandas dataframe and extract the accuracies\n",
    "accuracies = pd.DataFrame(history.history)[['accuracy', 'val_accuracy']]\n",
    "\n",
    "# Plot the accuracies\n",
    "accuracies.plot(figsize=(8, 5))\n",
    "plt.grid(True)\n",
    "plt.gca()\n",
    "plt.xlabel('Epoch')\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "70f61309-8958-4649-b6e3-ffe72575711c",
   "metadata": {},
   "outputs": [],
   "source": [
    "y_test_onehot = keras.utils.to_categorical(y_test, num_classes=len(list(np.unique(y_test))))\n",
    "\n",
    "plt.figure(figsize=(10,8))\n",
    "for i in range(len(list(np.unique(y_test)))):\n",
    "    fpr, tpr, _ = roc_curve(y_test_onehot[:, i], y_pred_probs[:, i])\n",
    "    roc_auc = auc(fpr, tpr)\n",
    "    plt.plot(fpr, tpr, label=f'Class {i} (AUC = {roc_auc:.2f})')\n",
    "\n",
    "plt.plot([0, 1], [0, 1], 'k--', label='Random')\n",
    "plt.xlabel('False Positive Rate')\n",
    "plt.ylabel('True Positive Rate')\n",
    "plt.title('ROC Curve - One-vs-Rest')\n",
    "plt.legend()\n",
    "plt.grid(True)\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "34c4ab78",
   "metadata": {},
   "source": [
    "### Convolutional neural network"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.11.7"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
